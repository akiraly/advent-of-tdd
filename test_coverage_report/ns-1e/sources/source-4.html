


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1252"> 
  <title>Coverage Report > Lens</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">day15p2</a>
</div>

<h1>Coverage Summary for Class: Lens (day15p2)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">Lens</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package day15p2
&nbsp;
&nbsp;import day15p2.Step.AddLens
&nbsp;import day15p2.Step.RemoveLens
&nbsp;
&nbsp;class Boxes {
&nbsp;  val boxes: List&lt;Box&gt; = (0..255).map { Box(it) }
&nbsp;
&nbsp;  fun processInitSeq(initSeqInput: String): Long {
&nbsp;    initSeqInput.parseSteps().forEach { step -&gt;
&nbsp;      when (step) {
&nbsp;        is AddLens -&gt; boxes[step.lens.hash].addLens(step.lens, step.focalLength)
&nbsp;        else -&gt; boxes[step.lens.hash].removeLens(step.lens)
&nbsp;      }
&nbsp;    }
&nbsp;
&nbsp;    return boxes.sumOf { it.focusingPower() }
&nbsp;  }
&nbsp;}
&nbsp;
&nbsp;data class Box(val id: Int) {
&nbsp;  val lenses: LinkedHashMap&lt;String, Int&gt; = LinkedHashMap()
&nbsp;
&nbsp;  fun addLens(lens: Lens, focalLength: Int) {
&nbsp;    lenses[lens.label] = focalLength
&nbsp;  }
&nbsp;
&nbsp;  fun removeLens(lens: Lens) {
&nbsp;    lenses.remove(lens.label)
&nbsp;  }
&nbsp;
&nbsp;  fun focusingPower(): Long = lenses.entries.asSequence().withIndex().sumOf { (index, entry) -&gt;
&nbsp;    val (_, focusingPower) = entry
&nbsp;
&nbsp;    (id + 1L) * (index + 1) * focusingPower
&nbsp;  }
&nbsp;}
&nbsp;
&nbsp;fun String.parseSteps(): List&lt;Step&gt; = parseInitSeq().map { input -&gt;
&nbsp;  val addLensParts = input.split(&#39;=&#39;)
&nbsp;  return@map if (addLensParts.size == 2) {
&nbsp;    AddLens(Lens(addLensParts[0]), addLensParts[1].toInt())
&nbsp;  } else {
&nbsp;    RemoveLens(Lens(input.removeSuffix(&quot;-&quot;)))
&nbsp;  }
&nbsp;}
&nbsp;
<b class="fc">&nbsp;data class Lens(val label: String, val hash: Int) {</b>
<b class="fc">&nbsp;  constructor(label: String) : this(label, HASH(label))</b>
&nbsp;}
&nbsp;
&nbsp;sealed interface Step {
&nbsp;  val lens: Lens
&nbsp;
&nbsp;  fun toText(): String
&nbsp;
&nbsp;  data class AddLens(override val lens: Lens, val focalLength: Int) : Step {
&nbsp;    override fun toText() = &quot;${lens.label}=$focalLength&quot;
&nbsp;  }
&nbsp;
&nbsp;  data class RemoveLens(override val lens: Lens) : Step {
&nbsp;    override fun toText() = &quot;${lens.label}-&quot;
&nbsp;  }
&nbsp;}
&nbsp;
&nbsp;private fun String.parseInitSeq(): List&lt;String&gt; = filter { it != &#39;\n&#39; }.split(&#39;,&#39;)
&nbsp;
&nbsp;fun HASH(input: String): Int = 0.HASH(input)
&nbsp;
&nbsp;fun Int.HASH(input: String): Int {
&nbsp;  var result = this
&nbsp;  for (i in input.indices) {
&nbsp;    result += input[i].code
&nbsp;    result *= 17
&nbsp;    result %= 256
&nbsp;  }
&nbsp;
&nbsp;  return result
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-12-15 11:04</div>
</div>
</body>
</html>
